# Gemini API 자동 칼로리 계산 설정

## ✅ 완료된 작업

- ✅ UI 개선: Pre-run Meal과 Total Calories를 나란히 배치
- ✅ 반응형 디자인: 데스크톱(옆으로), 모바일(위아래로)
- ✅ 자동 계산: 음식 입력 시 자동으로 칼로리 계산
- ✅ 로딩 표시: 계산 중 애니메이션
- ✅ 시각적 개선: 그라데이션 배경, 강조된 숫자

---

## 🎨 새로운 UI

### 데스크톱 화면:
```
┌─────────────────────────────────┬──────────────┐
│ Pre-run Meal                    │ Total Cal... │
│ ┌─────────────────────────────┐ │ ┌──────────┐ │
│ │ 치킨 샐러드, 바나나 2개...  │ │ │ 850 kcal │ │
│ └─────────────────────────────┘ │ └──────────┘ │
└─────────────────────────────────┴──────────────┘
```

### 모바일 화면:
```
Pre-run Meal
┌─────────────────────────────────┐
│ 치킨 샐러드, 바나나 2개, 단백질│
└─────────────────────────────────┘

Total Calories
┌─────────────────────────────────┐
│           850 kcal              │
└─────────────────────────────────┘
```

---

## 🚀 Gemini API KEY 설정

### 1단계: Gemini API 키 발급

1. **Google AI Studio 접속**
   - 🔗 https://makersuite.google.com/app/apikey

2. **Get API Key 클릭**

3. **Create API key 클릭**
   - 새 프로젝트 생성 또는 기존 프로젝트 선택

4. **API 키 복사**
   ```
   예: AIzaSy...
   ```

---

### 2단계: Vercel 환경 변수 추가

1. **Vercel 대시보드** 접속
   - 🔗 https://vercel.com/

2. **프로젝트 선택** → **Settings** → **Environment Variables**

3. **Add New 클릭**

4. **환경 변수 추가:**
   ```
   Name: GEMINI_API_KEY
   Value: [복사한 API 키]
   
   Environments:
   ✅ Production
   ✅ Preview
   ✅ Development
   ```

5. **Save 클릭**

---

### 3단계: 재배포

환경 변수 추가 후 **반드시 재배포** 필요:

```bash
cd "/Users/user/Library/Mobile Documents/com~apple~CloudDocs/cursor"
git add .
git commit -m "Improve calorie calculation UI - side by side layout"
git push origin main
```

또는 Vercel에서:
1. **Deployments 탭**
2. **⋯** → **Redeploy**

---

### 4단계: 테스트

배포 완료 후:

1. **기록 등록 페이지 접속**

2. **Pre-run Meal에 음식 입력:**
   ```
   치킨 샐러드, 바나나 2개, 단백질 쉐이크
   ```

3. **자동으로 Total Calories 칸에 계산 결과 표시:**
   ```
   850 kcal ✅
   ```

---

## 🎯 작동 방식

### 입력 → 자동 계산
```
1. 사용자가 "치킨 샐러드, 바나나 2개" 입력
   ↓
2. "계산 중..." 표시 (1초 디바운스)
   ↓
3. Gemini API 호출
   ↓
4. "850 kcal" 표시 ✅
```

### Gemini의 이해력
```
✅ "사과 1개" → 95 kcal
✅ "큰 사과" → 120 kcal
✅ "애플파이 한 조각" → 250 kcal
✅ "김밥 1줄" → 350 kcal
✅ "돼지고기 수육 500g, 김치, 맥주" → 850 kcal
```

---

## 💡 Gemini API 무료 한도

### 무료 플랜:
- **요청:** 60회/분
- **토큰:** 충분함
- **일반 사용에 무료로 사용 가능**

### 유료 플랜:
- 필요 시에만 (대규모 서비스)

---

## 🔍 문제 해결

### 문제 1: "서버 설정 오류가 발생했습니다"

**원인:** `GEMINI_API_KEY`가 설정되지 않음

**해결:**
1. Vercel Environment Variables 확인
2. `GEMINI_API_KEY` 추가
3. Production 환경 체크 확인
4. 재배포

---

### 문제 2: 칼로리가 계산되지 않음

**Vercel 로그 확인:**
1. **Vercel → Logs**
2. **검색: `칼로리` 또는 `Gemini`**

**로그 확인:**
```
✅ 정상:
🔑 GEMINI_API_KEY 확인: 설정됨 (길이: 39)
🔄 칼로리 계산 시작: 치킨 샐러드...
✅ Gemini 모델 초기화 완료: gemini-pro
📥 Gemini API 원본 응답: 850
✅ 칼로리 계산 성공: 850 kcal
```

```
❌ 문제:
❌ GEMINI_API_KEY가 설정되지 않았습니다.
```
→ 환경 변수 추가 필요

---

### 문제 3: API 할당량 초과

**로그:**
```
❌ API 할당량 초과 또는 제한
```

**해결:**
- 무료 한도: 60회/분
- 잠시 대기 후 재시도
- 또는 Google Cloud에서 할당량 증가

---

### 문제 4: "유효하지 않은 값"

**원인:** Gemini가 이해하지 못한 입력

**해결:**
더 명확하게 입력:
- ❌ "많이 먹음" 
- ✅ "치킨 한 마리, 콜라 500ml"

---

## 📊 사용 예시

### 한국 음식:
```
입력: "밥 한 공기, 된장찌개, 김치"
결과: 450 kcal ✅

입력: "삼겹살 200g, 상추, 쌈장, 소주 1병"
결과: 750 kcal ✅

입력: "비빔밥"
결과: 550 kcal ✅
```

### 서양 음식:
```
입력: "치킨 샐러드, 바나나 2개"
결과: 400 kcal ✅

입력: "피자 2조각, 콜라"
결과: 650 kcal ✅
```

### 간단한 입력:
```
입력: "사과 1개"
결과: 95 kcal ✅

입력: "단백질 쉐이크"
결과: 150 kcal ✅
```

---

## 🎨 UI 개선 사항

### Before:
```
Pre-run Meal
[입력란                           ]
----------------------------------------
Total Calories: 850 kcal
```

### After (데스크톱):
```
Pre-run Meal                Total Calories
[입력란              ]      [  850 kcal  ]
```

### 장점:
- ✅ 한눈에 보기 쉬움
- ✅ 공간 효율적
- ✅ 시각적으로 명확
- ✅ 반응형 디자인

---

## 🚀 완료!

설정이 완료되면:
- ✅ 음식 입력 시 자동으로 칼로리 계산
- ✅ 옆에 총 칼로리 표시
- ✅ 로딩 애니메이션
- ✅ 에러 처리
- ✅ 시각적으로 아름다운 UI

**사용자가 편리하게 Pre-run Meal의 칼로리를 확인할 수 있습니다!** 🍎📊
