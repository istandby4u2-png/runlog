# 서버 터미널 로그 확인 가이드

## 현재 상황
브라우저에서 다음 에러 메시지를 받았습니다:
```json
{
  "error": "칼로리 계산에 실패했습니다. 서버 터미널의 로그를 확인해주세요.",
  "details": "서버 터미널에서 \"❌\" 표시가 있는 로그를 확인하세요..."
}
```

이것은 `calculateCalories` 함수가 `null`을 반환했다는 의미입니다.

## 서버 터미널 로그 확인 방법

### 1. 서버 터미널 찾기
`npm run dev`를 실행한 터미널 창을 찾으세요.

### 2. 식사 입력 시 로그 확인
기록 등록 페이지에서 식사를 입력할 때, 서버 터미널에 다음과 같은 로그가 표시됩니다.

## 예상되는 로그 패턴

### 정상적인 경우:
```
📝 칼로리 계산 API 호출: 치킨 한 마리
🔑 GEMINI_API_KEY 확인: 설정됨 (길이: 39)
🔄 칼로리 계산 시작...
🔍 칼로리 계산 시작: 치킨 한 마리
🔑 GEMINI_API_KEY 상태: 설정됨 (길이: 39)
✅ Gemini 모델 초기화 완료: gemini-1.5-flash
📥 Gemini API 원본 응답: 1200
✅ 칼로리 계산 성공: 1200 kcal
📊 계산 결과: 1200
✅ 칼로리 계산 성공: 1200
```

### 문제가 있는 경우:

#### 문제 1: Gemini AI 초기화 실패
```
🔍 칼로리 계산 시작: 치킨 한 마리
🔑 GEMINI_API_KEY 상태: ❌ 설정되지 않음
❌ Gemini AI가 초기화되지 않았습니다.
❌ GEMINI_API_KEY를 확인해주세요.
```

**해결:** 서버를 재시작하세요.

#### 문제 2: Gemini API 호출 실패
```
🔍 칼로리 계산 시작: 치킨 한 마리
✅ Gemini 모델 초기화 완료: gemini-1.5-flash
❌ Gemini API 오류 발생!
❌ 오류 메시지: [에러 내용]
❌ HTTP 상태: [상태 코드]
```

**가능한 원인:**
- API 키가 잘못됨
- API 키에 권한이 없음
- 네트워크 연결 문제
- Gemini API 서비스 장애
- API 할당량 초과

**해결:**
1. [Google AI Studio](https://makersuite.google.com/app/apikey)에서 API 키 확인
2. 새 API 키 발급 후 `.env` 파일 업데이트
3. 서버 재시작

#### 문제 3: 응답에서 숫자를 찾을 수 없음
```
✅ Gemini 모델 초기화 완료: gemini-1.5-flash
📥 Gemini API 원본 응답: [응답 텍스트]
❌ 칼로리 계산 실패: 숫자를 찾을 수 없음. 응답: [응답 텍스트]
```

**해결:**
- 서버 터미널에 표시된 "원본 응답" 내용을 확인하세요
- Gemini API가 숫자가 아닌 다른 형식으로 응답한 경우입니다

#### 문제 4: 계산된 값이 유효하지 않음
```
📥 Gemini API 원본 응답: [응답]
❌ 칼로리 계산 실패: 유효하지 않은 값 [값]
```

**해결:**
- 계산된 값이 음수이거나 100,000을 초과하는 경우입니다
- Gemini API 응답을 확인하세요

## 확인해야 할 사항

서버 터미널에서 다음을 확인하세요:

1. **식사를 입력할 때:**
   - `🔍 칼로리 계산 시작:` 메시지가 표시되는지?
   - `✅ Gemini 모델 초기화 완료:` 메시지가 표시되는지?
   - `❌` 표시가 있는 에러 메시지가 있는지?
   - 어떤 에러 메시지가 표시되는지?

2. **에러 메시지의 전체 내용:**
   - 오류 타입
   - 오류 메시지
   - HTTP 상태 코드
   - 스택 트레이스

## 다음 단계

**서버 터미널의 로그를 복사해서 알려주세요!**

특히 다음 정보를 알려주세요:
1. 식사를 입력할 때 표시되는 모든 로그
2. `❌` 표시가 있는 에러 메시지의 전체 내용
3. `📥 Gemini API 원본 응답:` 메시지가 있다면 그 내용

이 정보를 주시면 정확한 원인을 파악할 수 있습니다.

## 일반적인 해결 방법

### 방법 1: 서버 재시작
```bash
# 서버 중지
Ctrl + C

# 서버 재시작
npm run dev
```

### 방법 2: API 키 재확인
1. [Google AI Studio](https://makersuite.google.com/app/apikey)에서 API 키 확인
2. 새 API 키 발급 (필요한 경우)
3. `.env` 파일 업데이트
4. 서버 재시작

### 방법 3: 네트워크 확인
- 인터넷 연결이 정상인지 확인
- 방화벽이나 프록시가 Gemini API를 차단하지 않는지 확인
